---
layout: post
title:  "基于遗传规划的选股因子挖掘"
info: "利用遗传规划算法，以Rank IC为适应度，以沪深300为股票池进行选股因子挖掘"
tech: "python"
type: 因子挖掘
---
## 摘要

遗传规划(genetic programming)是演化算法(evolutionary algorithm)的分支，是一种启发式的公式演化技术。遗传规划从随机生成的公式群体开始，通过模拟自然界中遗传进化的过程，来逐渐生成契合特定目标的公式群体。作为一种监督学习方法，遗传规划可以根据特定目标，发现某些隐藏的、难以通过人脑构建出的数学公式。传统的监督学习算法主要运用于特征与标签之间关系的拟合，而遗传规划则更多运用于特征挖掘(特征工程)。
在以往的因子研究中，常见的是“先有逻辑、后有公式”的方法（演绎法），如常见因子有估值、成长、波动率等。而遗传规划的方法可以在海量的数据中探索并进一步筛选有效的因子，在试图取解释因子的内涵，即“先有公式、后有逻辑”的方法（归纳法）。本篇报告将从第二个角度出发，利用启发式搜索试图挖掘出隐藏的有效因子。

## 关于遗传规划算法

#### 遗传规划的流程

* 随机生成一组未经选择和进化的原始公式会被随机生成(第一代公式)
* 通过某种规则计算每个公式的适应度，从中选出适合的个体作为下一代进化的父代。
* 将这些被选择出来的父代通过多种方法进化，形成不同的后代公式。
* 然后循环进行下一轮进化。随着迭代次数的增长，公式不断繁殖、变异、进化，从而不断逼近数据分布的真相。
  点击查看[ $\color{SteelBlue}{完整报告(CN)}$](../assets/pdfs/genetic_programming_ppt.pdf)

## 结论及展望

#### 项目学习总结

1. 了解了遗传规划的基本原理及操作。
2. 学习了Python中gplearn库中对遗传规划的使用，各种参数的定义。
3. 实验：选取了沪深300成分股，在牛市和牛熊两市时间段下的数据，并依据3日，20日收益率作为标签进行因子挖掘。
4. 单因子检验：回顾单因子分析流程，探索因子公式的表现。

#### 困难与解决对策

1. 聚宽上无法使用gplearn —— 跨平台使用本地jupyter与聚宽平台
2. 时间线太长，噪声太多 —— 取特定的牛熊时间段训练
3. 函数太少缺少灵活性 —— 改写了部分函数使得参数可变
4. 因子长度太长 ——  加惩罚因子参数，约束公式深度，防止过拟合
5. 无法批量生成因子 —— 研究gplearn参数文档，找到对应方法

#### 仍待提升的部分

1. 因子预处理： 无法在本地用聚宽的中性化函数，因子在剔除行业、市值等方面影响后是否有稳定的RankIC仍待验证。
2. 因子分析：较为依赖聚宽平台的因子分析模板，可将单因子测试的过程引入gplearn，对待挖掘因子进行传统风格因子中性化处理。
3. 数据量及速度：当数据量变大时，可引入并行运算技术，加快因子矩阵的运算速度。
